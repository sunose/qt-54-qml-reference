<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- resources.qdoc -->
  <title>Defining JavaScript Resources In QML | Qt QML 5.4</title>
  <link rel="stylesheet" type="text/css" href="style/online.css" />
  <link rel="shortcut icon" href="//d3hp9ud7yvwzy0.cloudfront.net/wp-content/themes/oneqt/images/favicon.ico.gzip" />
 
</head>
<body>
<div class="header" id="header">
<header id="navbar" class="">
        <div class="cookies_yum">
            <div>
                <img src="http://qt.io/wp-content/themes/oneqt/assets/images/cookie_small.png" align="left">
                <p class="close_button">
                    We bake cookies in your browser for a better experience.  Using this site means that you consent. <a href="//qt.io/terms-conditions/">Read More</a>
                </p>
                <a class="close"></a>
            </div>
        </div>
        <div class="container">
                <div class="navbar-header clearfix">
                    <a href="#" class="navbar-toggle">
                        <figure>
                            <span class="line"></span>
                        </figure>
                        <span>Menu</span>
                    </a>
                    <ul id="menuextras">
                        <li>
                            <a href="//qt.io/partners/" data-icon="">
                                <span>Partners</span>
                            </a>
                        </li>
                        <li>
                            <a target="_blank" href="http://blog.qt.io/" data-icon="">
                                <span>Blog</span>
                            </a>
                        </li>
                        <li class="sign-in">
                             <a data-icon="" class="signin" href="https://account.qt.io/login"><span>Sign in</span></a>
                        </li>
                    </ul>
                    <a href="http://qt.io/" class="navbar-oneQt retina" data-icon="">
                    </a>
                    <nav class="navbar-menu clearfix" role="navigation">
<ul id="mainmenu" class="menu"><li id="menu-item-18" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-18"><a href="http://www.qt.io/download/">Download</a></li>
<li id="menu-item-12207" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12207"><a href="http://www.qt.io/qt-for-device-creation/">Device Creation</a></li>
<li id="menu-item-12208" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12208"><a href="http://www.qt.io/application-development/">Application Development</a></li>
<li id="menu-item-1381" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1381"><a href="http://www.qt.io/services/">Services</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20"><a href="http://www.qt.io/developers/">Developers</a></li>
</ul>                        <ul class="menuextraslanguages">
                            <li class="active dark"><a class="dark" href="http://qt.io/support/">EN</a></li><li class="dark"><a class="dark" href="http://qt.io/ru/">RU</a></li><li class="dark"><a class="dark" href="http://qt.io/zh-hans/">ZH</a></li></ul>
                    </nav>
                </div>
            </div>
<div class="big_bar account" style="">
    <div class="container">
        <h1><!-- mclude oneqt_no_cache_bMrsJxAh /wp-content/themes/oneqt/php_login_info_bottom_header.php --><!-- /mclude oneqt_no_cache_bMrsJxAh -->
            <div class="col-1 right big_bar_button account" style="margin-top:5px !important;"></div>
        </h1>
    </div>
</div>
</header>
</div>
<div class="main">
<div class="main-rounded">
<div class="navigationbar">
    <ul class="sub-navigation">
        <li><a href="http://wiki.qt.io/">Wiki</a></li>
        <li><a href="http://doc.qt.io/" class="active">Documentation</a></li>
        <li><a href="http://forum.qt.io/">Forum</a></li>
        <li><a href="https://bugreports.qt.io/">Bug Reports</a></li>
        <li><a href="https://codereview.qt-project.org/">Code Review</a></li>
    </ul>
    <div id="main_title_bar">
        <h1>Qt Documentation</h1>
        <div class="search_bar">
        <script>
            (function() {
                var cx = '003672281345882769388:1y4pftuq8so';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
            })();
        </script>
        <gcse:searchbox-only resultsUrl="search-results.html"></gcse:searchbox-only>
    </div></div>
    <ul>
<li><a href="index.html">Qt 5.4</a></li>
<li><a href="qtqml-index.html">Qt QML</a></li>
<li>Defining JavaScript Resources In QML</li>
    </ul>
</div>
<div class="content">
    <div class="line">
        <div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#code-behind-implementation-resource">Code-Behind Implementation Resource</a></li>
<li class="level1"><a href="#shared-javascript-resources-libraries">Shared JavaScript Resources (Libraries)</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<div class="context">
<h1 class="title">Defining JavaScript Resources In QML</h1>
<span class="subtitle"></span>
<!-- $$$qtqml-javascript-resources.html-description -->
<div class="descr"> <a name="details"></a>
<p>The program logic for a QML application may be defined in JavaScript. The JavaScript code may either be defined in-line in QML documents, or separated into JavaScript files (known as <code>JavaScript Resources</code> in QML).</p>
<p>There are two different kinds of JavaScript resources which are supported in QML: code-behind implementation files, and shared (library) files. Both kinds of JavaScript resource may be <a href="qtqml-javascript-imports.html">imported</a> by other JavaScript resources, or included in <a href="qtqml-modules-topic.html">QML modules</a>.</p>
<a name="code-behind-implementation-resource"></a>
<h2 id="code-behind-implementation-resource">Code-Behind Implementation Resource</h2>
<p>Most JavaScript files imported into a QML document are stateful implementations for the QML document importing them. In these cases, each instance of the QML object type defined in the document requires a separate copy of the JavaScript objects and state in order to behave correctly.</p>
<p>The default behavior when importing JavaScript files is to provide a unique, isolated copy for each QML component instance. If that JavaScript file does not import any resources or modules with a <code>.import</code> statement, its code will run in the same scope as the QML component instance and consequently can access and manipulate the objects and properties declared in that QML component. Otherwise, it will have its own unique scope, and objects and properties of the QML component should be passed to the functions of the JavaScript file as parameters if they are required.</p>
<p>An example of a code-behind implementation resource follows:</p>
<pre class="qml"><span class="comment">// MyButton.qml</span>
import QtQuick 2.0
import &quot;my_button_impl.js&quot; as Logic <span class="comment">// a new instance of this JavaScript resource is loaded for each instance of Button.qml</span>

<span class="type"><a href="qml-qtquick-rectangle.html">Rectangle</a></span> {
    <span class="name">id</span>: <span class="name">rect</span>
    <span class="name">width</span>: <span class="number">200</span>
    <span class="name">height</span>: <span class="number">100</span>
    <span class="name">color</span>: <span class="string">&quot;red&quot;</span>

    <span class="type"><a href="qml-qtquick-mousearea.html">MouseArea</a></span> {
        <span class="name">id</span>: <span class="name">mousearea</span>
        <span class="name">anchors</span>.fill: <span class="name">parent</span>
        <span class="name">onClicked</span>: <span class="name">Logic</span>.<span class="name">onClicked</span>(<span class="name">rect</span>)
    }
}</pre>
<pre class="qml">// my_button_impl.js
var clickCount = 0;   // this state is separate for each instance of MyButton
function onClicked(btn) {
    clickCount += 1;
    if ((clickCount % 5) == 0) {
        obj.color = Qt.rgba(1,0,0,1);
    } else {
        obj.color = Qt.rgba(0,1,0,1);
    }
}</pre>
<p>In general, simple logic should be defined in-line in the QML file, but more complex logic should be separated into code-behind implementation resources for maintainability and readability.</p>
<a name="shared-javascript-resources-libraries"></a>
<h2 id="shared-javascript-resources-libraries">Shared JavaScript Resources (Libraries)</h2>
<p>Some JavaScript files act more like libraries - they provide a set of helper functions that take input and compute output, but never manipulate QML component instances directly.</p>
<p>As it would be wasteful for each QML component instance to have a unique copy of these libraries, the JavaScript programmer can indicate a particular file is a shared library through the use of a pragma, as shown in the following example.</p>
<pre class="cpp"><span class="comment">// factorial.js</span>
<span class="operator">.</span>pragma library

var factorialCount <span class="operator">=</span> <span class="number">0</span>;

function factorial(a) {
    a <span class="operator">=</span> parseInt(a);

    <span class="comment">// factorial recursion</span>
    <span class="keyword">if</span> (a <span class="operator">&gt;</span> <span class="number">0</span>)
        <span class="keyword">return</span> a <span class="operator">*</span> factorial(a <span class="operator">-</span> <span class="number">1</span>);

    <span class="comment">// shared state</span>
    factorialCount <span class="operator">+</span><span class="operator">=</span> <span class="number">1</span>;

    <span class="comment">// recursion base-case.</span>
    <span class="keyword">return</span> <span class="number">1</span>;
}

function factorialCallCount() {
    <span class="keyword">return</span> factorialCount;
}</pre>
<p>The pragma declaration must appear before any JavaScript code excluding comments.</p>
<p>Note that multiple QML documents can import <code>&quot;factorial.js&quot;</code> and call the factorial and factorialCallCount functions that it provides. The state of the JavaScript import is shared across the QML documents which import it, and thus the return value of the factorialCallCount function may be non-zero when called within a QML document which never calls the factorial function.</p>
<p>For example:</p>
<pre class="qml"><span class="comment">// Calculator.qml</span>
import QtQuick 2.0
import &quot;factorial.js&quot; as FactorialCalculator <span class="comment">// this JavaScript resource is only ever loaded once by the engine, even if multiple instances of Calculator.qml are created</span>

<span class="type"><a href="qml-qtquick-text.html">Text</a></span> {
    <span class="name">width</span>: <span class="number">500</span>
    <span class="name">height</span>: <span class="number">100</span>
    property <span class="type">int</span> <span class="name">input</span>: <span class="number">17</span>
    <span class="name">text</span>: <span class="string">&quot;The factorial of &quot;</span> <span class="operator">+</span> <span class="name">input</span> <span class="operator">+</span> <span class="string">&quot; is: &quot;</span> <span class="operator">+</span> <span class="name">FactorialCalculator</span>.<span class="name">factorial</span>(<span class="name">input</span>)
}</pre>
<p>As they are shared, .pragma library files cannot access QML component instance objects or properties directly, although QML values can be passed as function parameters.</p>
</div>
<!-- @@@qtqml-javascript-resources.html -->
   </div>
   <p class="copy-notice">
   <acronym title="Copyright">&copy;</acronym> 2015 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are trademarks of The Qt Company Ltd.     in Finland and/or other countries worldwide. All other trademarks are property
   of their respective owners. </p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<footer id="footerbar">
    <div class="footer-main">
            <div class="container clearfix">
                <nav class="footer-nav clearfix">
                    <div class="menu-footer-menu-container"><ul id="menu-footer-menu" class="menu"><li id="menu-item-1350" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1350"><a href="http://qt.io/about-us/">About us</a>
<ul class="sub-menu">
    <li id="menu-item-1353" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1353"><a href="http://qt.io/events/">Training &amp; Events</a></li>
    <li id="menu-item-1596" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1596"><a href="http://qt.io/news/">News</a></li>
    <li id="menu-item-1354" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1354"><a href="http://qt.io/resource-center/">Resource Center</a></li>
    <li id="menu-item-1352" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1352"><a href="http://qt.io/partners/">Partners</a></li>
    <li id="menu-item-1349" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1349"><a href="http://qt.io/careers/">Careers</a></li>
    <li id="menu-item-11676" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11676"><a href="http://qt.io/locations/">Locations</a></li>
</ul>
</li>
<li id="menu-item-1355" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1355"><a href="http://qt.io/product/">Product</a>
<ul class="sub-menu">
    <li id="menu-item-1358" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1358"><a href="http://qt.io/qt-framework/">Qt Framework</a></li>
    <li id="menu-item-1356" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1356"><a href="http://qt.io/qt-features/">Qt Features</a></li>
    <li id="menu-item-1359" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1359"><a href="http://qt.io/qt-quick/">Qt Quick</a></li>
    <li id="menu-item-1357" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1357"><a href="http://qt.io/qt-for-device-creation/">Qt for Device Creation</a></li>
    <li id="menu-item-10159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10159"><a href="http://qt.io/mobile-app-development/">Qt for Mobile Apps</a></li>
    <li id="menu-item-12576" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12576"><a href="http://qt.io/qt-in-use/">Qt in Use</a></li>
</ul>
</li>
<li id="menu-item-33" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-33"><a href="http://qt.io/developers/">Developers</a>
<ul class="sub-menu">
    <li id="menu-item-1365" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1365"><a href="http://doc.qt.io/">Documentation</a></li>
    <li id="menu-item-1364" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1364"><a href="http://doc.qt.io/qt-5/qtexamplesandtutorials.html">Examples &amp; Tutorials</a></li>
    <li id="menu-item-1363" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1363"><a href="http://doc.qt.io/qt-5/topics-app-development.html">Tools</a></li>
    <li id="menu-item-1361" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1361"><a href="http://wiki.qt.io/">Wiki</a></li>
    <li id="menu-item-1360" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1360"><a href="http://forum.qt.io/">Forums</a></li>
    <li id="menu-item-1362" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1362"><a href="http://wiki.qt.io/Qt_Contribution_Guidelines">Contribute to Qt</a></li>
</ul>
</li>
<li id="menu-item-1347" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-1347"><a href="http://qt.io/services/">Services</a>
<ul class="sub-menu">
    <li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page page_item page-item-14 menu-item-32"><a href="http://qt.io/support/">Support</a></li>
    <li id="menu-item-4028" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4028"><a href="http://qt.io/services-technology-evaluation/">Technology Evaluation</a></li>
    <li id="menu-item-4027" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4027"><a href="http://qt.io/services-proof-of-concept/">Proof of Concept</a></li>
    <li id="menu-item-4026" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4026"><a href="http://qt.io/services-design-implementation/">Design &amp; Implementation</a></li>
    <li id="menu-item-4025" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4025"><a href="http://qt.io/services-productization/">Productization</a></li>
    <li id="menu-item-5124" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5124"><a href="https://qtcloudservices.com/">Qt Cloud Services</a></li>
</ul>
</li>
<li id="menu-item-1403" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1403"><a href="http://qt.io/download/">Download</a>
<ul class="sub-menu">
    <li id="menu-item-11677" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11677"><a href="http://qt.io/download">Free 30-Day Trial</a></li>
    <li id="menu-item-1982" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1982"><a href="http://qt.io/buy-enterprise-step-2/">Enterprise</a></li>
    <li id="menu-item-1985" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1985"><a href="http://qt.io/buy-professional-step-2/">Professional</a></li>
    <li id="menu-item-3346" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3346"><a href="http://qt.io/buy-indiemobile-step-2/">Indie Mobile</a></li>
    <li id="menu-item-3343" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3343"><a href="http://qt.io/download-open-source/">Community</a></li>
    <li id="menu-item-1415" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1415"><a href="http://qt.io/terms-conditions/">Legal | Terms &amp; Conditions</a></li>
</ul>
</li>
</ul></div></nav>
<a href="http://qt.io/about-us/" target="_blank" class="theqtcompany"></a>
    <div class="footer-social clearfix">
        <div class="facebook">
            <iframe scrolling="no" frameborder="0" allowTransparency="true" src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fqtbydigia&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=true&amp;share=false&amp;height=21" style="border:none;overflow:hidden;height:21px;"></iframe>
        </div>
        <div class="twitter">
            <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" src="http://platform.twitter.com/widgets/follow_button.33b190ea0cba008796487b65df7f6d8e.en.html#_=1414403615717&amp;id=twitter-widget-0&amp;lang=en&amp;screen_name=qtproject&amp;show_count=true&amp;show_screen_name=false&amp;size=m" class="twitter-follow-button twitter-follow-button" title="Twitter Follow Button" data-twttr-rendered="true" style="width: 160px; height: 20px;"></iframe>
        </div>
    </div>
</div>
</div>
<div class="disclaimer">
<div class="container clearfix no_discs">
    <ul id="menu-footer-submenu" class="right clearfix"><li id="menu-item-1795" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1795"><a title="Sign into your account." href="https://account.qt.io/login">Sign In</a></li>
      <li id="menu-item-10375" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10375"><a href="mailto:feedback@theqtcompany.com?Subject=Feedback%20about%20doc.qt.io%20site">Feedback</a></li>
      <li id="menu-item-1494" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1494"><a href="http://qt.io/contact-us/">Contact us</a></li>
      <li id="menu-item-4472" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4472"><a href="http://qt.io/about-us/">© 2015 The Qt Company</a></li>
    </ul>
</div>
</div>
</footer>
</div>
</body>
</html>
